scale_fill_manual(values = biz.cols, guide = FALSE) +
theme(
plot.background = element_blank(),
panel.background = element_blank(),
strip.background = element_rect(fill ="#787c84"),
strip.text = element_text(colour = "white"),
# axis.text = element_blank(),
# axis.ticks = element_blank(),
axis.line.x = element_line(colour = "black"),
axis.line.y = element_blank(),
axis.text.y = element_blank(),
axis.text.x = element_text(angle = 90),
axis.ticks = element_blank()
)
ggplot(bar2.df) +
geom_bar(
aes(x = Business, y = value, fill = Business),
stat = "identity"
) +
facet_wrap(~ measure, scales = "free_y") +
geom_text(
aes(x = Business, y = value, label = value.label, vjust = textBelow)
) +
scale_y_continuous(name = NULL, expand = c(0, 0)) +
scale_x_discrete(name = NULL) +
scale_fill_manual(values = biz.cols, guide = FALSE) +
theme(
plot.background = element_blank(),
panel.background = element_blank(),
strip.background = element_rect(fill ="#787c84"),
strip.text = element_text(colour = "white"),
# axis.text = element_blank(),
# axis.ticks = element_blank(),
axis.line.x = element_line(colour = "black"),
axis.line.y = element_blank(),
axis.text.y = element_blank(),
axis.text.x = element_text(angle = 90, vjust = 0),
axis.ticks = element_blank()
)
ggplot(bar2.df) +
geom_bar(
aes(x = Business, y = value, fill = Business),
stat = "identity"
) +
facet_wrap(~ measure, scales = "free_y") +
geom_text(
aes(x = Business, y = value, label = value.label, vjust = textBelow)
) +
scale_y_continuous(name = NULL, expand = c(0, 0)) +
scale_x_discrete(name = NULL) +
scale_fill_manual(values = biz.cols, guide = FALSE) +
theme(
plot.background = element_blank(),
panel.background = element_blank(),
strip.background = element_rect(fill ="#787c84"),
strip.text = element_text(colour = "white"),
# axis.text = element_blank(),
# axis.ticks = element_blank(),
axis.line.x = element_line(colour = "black"),
axis.line.y = element_blank(),
axis.text.y = element_blank(),
axis.text.x = element_text(angle = 90, hjust = 0),
axis.ticks = element_blank()
)
ggplot(bar2.df) +
geom_bar(
aes(x = Business, y = value, fill = Business),
stat = "identity"
) +
facet_wrap(~ measure, scales = "free_y") +
geom_text(
aes(x = Business, y = value, label = value.label, vjust = textBelow)
) +
scale_y_continuous(name = NULL, expand = c(0, 0)) +
scale_x_discrete(name = NULL) +
scale_fill_manual(values = biz.cols, guide = FALSE) +
theme(
plot.background = element_blank(),
panel.background = element_blank(),
strip.background = element_rect(fill ="#787c84"),
strip.text = element_text(colour = "white"),
# axis.text = element_blank(),
# axis.ticks = element_blank(),
axis.line.x = element_line(colour = "black"),
axis.line.y = element_blank(),
axis.text.y = element_blank(),
axis.text.x = element_text(angle = 90, hjust = 1),
axis.ticks = element_blank()
)
ggsave("./Plots/plot07_compare_FREQvsSEV_bar.png")
ggplot(bar2.df) +
geom_bar(
aes(x = Business, y = value, fill = Business),
stat = "identity"
) +
facet_wrap(~ measure, scales = "free_y") +
geom_text(
aes(x = Business, y = value, label = value.label, vjust = textBelow),
size = 6
) +
scale_y_continuous(name = NULL, expand = c(0, 0)) +
scale_x_discrete(name = NULL) +
scale_fill_manual(values = biz.cols, guide = FALSE) +
theme(
plot.background = element_blank(),
panel.background = element_blank(),
strip.background = element_rect(fill ="#787c84"),
strip.text = element_text(colour = "white"),
# axis.text = element_blank(),
# axis.ticks = element_blank(),
axis.line.x = element_line(colour = "black"),
axis.line.y = element_blank(),
axis.text.y = element_blank(),
axis.text.x = element_text(angle = 90, hjust = 1),
axis.ticks = element_blank()
)
ggplot(bar2.df) +
geom_bar(
aes(x = Business, y = value, fill = Business),
stat = "identity"
) +
facet_wrap(~ measure, scales = "free_y") +
geom_text(
aes(x = Business, y = value, label = value.label, vjust = textBelow),
size = 1
) +
scale_y_continuous(name = NULL, expand = c(0, 0)) +
scale_x_discrete(name = NULL) +
scale_fill_manual(values = biz.cols, guide = FALSE) +
theme(
plot.background = element_blank(),
panel.background = element_blank(),
strip.background = element_rect(fill ="#787c84"),
strip.text = element_text(colour = "white"),
# axis.text = element_blank(),
# axis.ticks = element_blank(),
axis.line.x = element_line(colour = "black"),
axis.line.y = element_blank(),
axis.text.y = element_blank(),
axis.text.x = element_text(angle = 90, hjust = 1),
axis.ticks = element_blank()
)
ggplot(bar2.df) +
geom_bar(
aes(x = Business, y = value, fill = Business),
stat = "identity"
) +
facet_wrap(~ measure, scales = "free_y") +
geom_text(
aes(x = Business, y = value, label = value.label, vjust = textBelow),
size = 4
) +
scale_y_continuous(name = NULL, expand = c(0, 0)) +
scale_x_discrete(name = NULL) +
scale_fill_manual(values = biz.cols, guide = FALSE) +
theme(
plot.background = element_blank(),
panel.background = element_blank(),
strip.background = element_rect(fill ="#787c84"),
strip.text = element_text(colour = "white"),
# axis.text = element_blank(),
# axis.ticks = element_blank(),
axis.line.x = element_line(colour = "black"),
axis.line.y = element_blank(),
axis.text.y = element_blank(),
axis.text.x = element_text(angle = 90, hjust = 1),
axis.ticks = element_blank()
)
ggplot(bar2.df) +
geom_bar(
aes(x = Business, y = value, fill = Business),
stat = "identity"
) +
facet_wrap(~ measure, scales = "free_y") +
geom_text(
aes(x = Business, y = value, label = value.label, vjust = textBelow),
size = 3
) +
scale_y_continuous(name = NULL, expand = c(0, 0)) +
scale_x_discrete(name = NULL) +
scale_fill_manual(values = biz.cols, guide = FALSE) +
theme(
plot.background = element_blank(),
panel.background = element_blank(),
strip.background = element_rect(fill ="#787c84"),
strip.text = element_text(colour = "white"),
# axis.text = element_blank(),
# axis.ticks = element_blank(),
axis.line.x = element_line(colour = "black"),
axis.line.y = element_blank(),
axis.text.y = element_blank(),
axis.text.x = element_text(angle = 90, hjust = 1),
axis.ticks = element_blank()
)
ggsave("./Plots/plot07_compare_FREQvsSEV_bar.png")
bar2.df <- biz.df %>%
select(Business, Freq, Severity) %>%
gather("measure", "value", -Business) %>%
# for labels
group_by(measure) %>%
mutate(
max.val = max(value),
textBelow = value > (0.75*max.val,)
value.label = round(value) %>% comma()
) %>%
ungroup()
ggplot(bar2.df) +
geom_bar(
aes(x = Business, y = value, fill = Business),
stat = "identity"
) +
facet_wrap(~ measure, scales = "free_y") +
geom_text(
aes(x = Business, y = value, label = value.label, vjust = textBelow),
size = 3
) +
scale_y_continuous(name = NULL, expand = c(0, 0)) +
scale_x_discrete(name = NULL) +
scale_fill_manual(values = biz.cols, guide = FALSE) +
theme(
plot.background = element_blank(),
panel.background = element_blank(),
strip.background = element_rect(fill ="#787c84"),
strip.text = element_text(colour = "white"),
# axis.text = element_blank(),
# axis.ticks = element_blank(),
axis.line.x = element_line(colour = "black"),
axis.line.y = element_blank(),
axis.text.y = element_blank(),
axis.text.x = element_text(angle = 90, hjust = 1),
axis.ticks = element_blank()
)
bar2.df <- biz.df %>%
select(Business, Freq, Severity) %>%
gather("measure", "value", -Business) %>%
# for labels
group_by(measure) %>%
mutate(
max.val = max(value),
textBelow = value > (0.75*max.val,)
value.label = round(value) %>% comma()
) %>%
ungroup()
bar2.df <- biz.df %>%
select(Business, Freq, Severity) %>%
gather("measure", "value", -Business) %>%
# for labels
group_by(measure) %>%
mutate(
max.val = max(value),
textBelow = value > (0.75*max.val),
value.label = round(value) %>% comma()
) %>%
ungroup()
ggplot(bar2.df) +
geom_bar(
aes(x = Business, y = value, fill = Business),
stat = "identity"
) +
facet_wrap(~ measure, scales = "free_y") +
geom_text(
aes(x = Business, y = value, label = value.label, vjust = textBelow),
size = 3
) +
scale_y_continuous(name = NULL, expand = c(0, 0)) +
scale_x_discrete(name = NULL) +
scale_fill_manual(values = biz.cols, guide = FALSE) +
theme(
plot.background = element_blank(),
panel.background = element_blank(),
strip.background = element_rect(fill ="#787c84"),
strip.text = element_text(colour = "white"),
# axis.text = element_blank(),
# axis.ticks = element_blank(),
axis.line.x = element_line(colour = "black"),
axis.line.y = element_blank(),
axis.text.y = element_blank(),
axis.text.x = element_text(angle = 90, hjust = 1),
axis.ticks = element_blank()
)
ggsave("./Plots/plot07_compare_FREQvsSEV_bar.png")
str(bar2.df)
biz.df
ggplot(bar2.df) +
geom_point(
aes(x = Freq, y = Severity, colour = Business)
) +
scale_fill_manual(values = biz.cols, guide = FALSE) +
theme(
plot.background = element_blank(),
panel.background = element_blank(),
strip.background = element_rect(fill ="#787c84"),
strip.text = element_text(colour = "white"),
axis.line = element_line(colour = "black")
)
ggplot(biz.df) +
geom_point(
aes(x = Freq, y = Severity, colour = Business)
) +
scale_fill_manual(values = biz.cols, guide = FALSE) +
theme(
plot.background = element_blank(),
panel.background = element_blank(),
strip.background = element_rect(fill ="#787c84"),
strip.text = element_text(colour = "white"),
axis.line = element_line(colour = "black")
)
ggplot(biz.df) +
geom_point(
aes(x = Freq, y = Severity, colour = Business)
) +
scale_fill_manual(values = biz.cols, guide = FALSE) +
scale_y_continuous(label = comma) +
theme(
plot.background = element_blank(),
panel.background = element_blank(),
strip.background = element_rect(fill ="#787c84"),
strip.text = element_text(colour = "white"),
axis.line = element_line(colour = "black")
)
return(temp.lab)
amtLab <- function(x){
temp.amt <- x / 1e3
temp.lab <- paste0(temp.amt, "k")
return(temp.lab)
}
ggplot(biz.df) +
geom_point(
aes(x = Freq, y = Severity, colour = Business)
) +
scale_fill_manual(values = biz.cols, guide = FALSE) +
scale_y_continuous(label = amtLab) +
theme(
plot.background = element_blank(),
panel.background = element_blank(),
strip.background = element_rect(fill ="#787c84"),
strip.text = element_text(colour = "white"),
axis.line = element_line(colour = "black")
)
ggplot(biz.df) +
geom_point(
aes(x = Freq, y = Severity, colour = Business)
) +
geom_text(
aes(x = Freq, y = Severity, label = Business)
) +
scale_colour_manual(values = biz.cols, guide = FALSE) +
scale_y_continuous(label = amtLab) +
theme(
plot.background = element_blank(),
panel.background = element_blank(),
strip.background = element_rect(fill ="#787c84"),
strip.text = element_text(colour = "white"),
axis.line = element_line(colour = "black")
)
bizPt.df <- biz.df %>%
mutate(
textLeft = Freq == max(Freq)
)
ggplot(biz.df) +
geom_point(
aes(x = Freq, y = Severity, colour = Business)
) +
geom_text(
aes(x = Freq, y , Severity, label = Business, hjust = textLeft)
) +
scale_colour_manual(values = biz.cols, guide = FALSE) +
scale_y_continuous(label = amtLab) +
theme(
plot.background = element_blank(),
panel.background = element_blank(),
strip.background = element_rect(fill ="#787c84"),
strip.text = element_text(colour = "white"),
axis.line = element_line(colour = "black")
)
ggplot(biz.df) +
geom_point(
aes(x = Freq, y = Severity, colour = Business)
) +
geom_text(
aes(x = Freq, y = Severity, label = Business, hjust = textLeft)
) +
scale_colour_manual(values = biz.cols, guide = FALSE) +
scale_y_continuous(label = amtLab) +
theme(
plot.background = element_blank(),
panel.background = element_blank(),
strip.background = element_rect(fill ="#787c84"),
strip.text = element_text(colour = "white"),
axis.line = element_line(colour = "black")
)
ggplot(bizPt.df) +
geom_point(
aes(x = Freq, y = Severity, colour = Business)
) +
geom_text(
aes(x = Freq, y = Severity, label = Business, hjust = textLeft)
) +
scale_colour_manual(values = biz.cols, guide = FALSE) +
scale_y_continuous(label = amtLab) +
theme(
plot.background = element_blank(),
panel.background = element_blank(),
strip.background = element_rect(fill ="#787c84"),
strip.text = element_text(colour = "white"),
axis.line = element_line(colour = "black")
)
ggplot(biz.df) +
geom_point(
aes(x = Freq, y = Severity, colour = Business)
) +
geom_text(
aes(x = Freq, y = Severity, label = Business),
check_overlap = TRUE
) +
scale_colour_manual(values = biz.cols, guide = FALSE) +
scale_y_continuous(label = amtLab) +
theme(
plot.background = element_blank(),
panel.background = element_blank(),
strip.background = element_rect(fill ="#787c84"),
strip.text = element_text(colour = "white"),
axis.line = element_line(colour = "black")
)
ggplot(bizPt.df) +
geom_point(
aes(x = Freq, y = Severity, colour = Business)
) +
geom_text(
aes(x = Freq, y = Severity, label = Business, hjust = textLeft),
check_overlap = TRUE
) +
scale_colour_manual(values = biz.cols, guide = FALSE) +
scale_y_continuous(label = amtLab) +
theme(
plot.background = element_blank(),
panel.background = element_blank(),
strip.background = element_rect(fill ="#787c84"),
strip.text = element_text(colour = "white"),
axis.line = element_line(colour = "black")
)
install.packages("ggrepel")
library(ggrepel)
?geom_text_repel
ggplot(biz.df) +
geom_point(
aes(x = Freq, y = Severity, colour = Business)
) +
geom_text_repel(
aes(x = Freq, y = Severity, label = Business)
) +
scale_colour_manual(values = biz.cols, guide = FALSE) +
scale_y_continuous(label = amtLab) +
theme(
plot.background = element_blank(),
panel.background = element_blank(),
strip.background = element_rect(fill ="#787c84"),
strip.text = element_text(colour = "white"),
axis.line = element_line(colour = "black")
)
ggplot(biz.df) +
geom_point(
aes(x = Freq, y = Severity, colour = Business),
size = 8
) +
geom_text_repel(
aes(x = Freq, y = Severity, label = Business)
) +
scale_colour_manual(values = biz.cols, guide = FALSE) +
scale_y_continuous(label = amtLab) +
theme(
plot.background = element_blank(),
panel.background = element_blank(),
strip.background = element_rect(fill ="#787c84"),
strip.text = element_text(colour = "white"),
axis.line = element_line(colour = "black")
)
ggplot(biz.df) +
geom_point(
aes(x = Freq, y = Severity, colour = Business),
size = 8, alpha = 1/2
) +
geom_text_repel(
aes(x = Freq, y = Severity, label = Business)
) +
scale_colour_manual(values = biz.cols, guide = FALSE) +
scale_y_continuous(label = amtLab) +
theme(
plot.background = element_blank(),
panel.background = element_blank(),
strip.background = element_rect(fill ="#787c84"),
strip.text = element_text(colour = "white"),
axis.line = element_line(colour = "black")
)
ggplot(biz.df) +
geom_point(
aes(x = Freq, y = Severity, colour = Business),
size = 8, alpha = 0.75
) +
geom_text_repel(
aes(x = Freq, y = Severity, label = Business)
) +
scale_colour_manual(values = biz.cols, guide = FALSE) +
scale_y_continuous(label = amtLab) +
theme(
plot.background = element_blank(),
panel.background = element_blank(),
strip.background = element_rect(fill ="#787c84"),
strip.text = element_text(colour = "white"),
axis.line = element_line(colour = "black")
)
ggsave("./Plots/plot08_compare_FREQvsSEV_scatter.png")
